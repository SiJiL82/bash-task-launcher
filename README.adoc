= Task Launcher
:imagesdir: ./docs/images
:source-highlighter: highlight.js
:toc:

== About
Task Launcher is a bash based CLI script that can be used to run a series of commonly run commands with a shorter alias. +
For example, if you regularly run the following commands to build and run your project:
[source,bash]
----
cd ~/projects/my_project/src
npm build-dev
npm start
----
You could create a Task Launcher task called `build-and-run` that contains these commands, and run them from anywhere in your shell by simply calling `tl build-and-run`.

Task Launcher also includes a CLI menu for all the tasks you've created, allowing you to execute the tasks available by entering their numeric input. +
The menu includes support for sub-menus, allowing you to group related tasks together.

== Getting Started
To start using Task Launcher, clone this repo: +
`git clone https://github.com/SiJiL82/bash-task-launcher.git`

If you want to create a task launcher with tasks for your existing project (for example to speed up common developer tasks),
clone this repo inside your project. +
You can change the launcher command to one relative to your project, which allows you to have a Task Launcher config specifically for your project. +
To do so, simply rename the `tl` file to whatever you want the command to be to call your launcher. +
For example, if you're working on "My Cool Website", you could rename `tl` to `mcw` which will allow you to call the launcher tasks with `mcw build-and-run`.  

=== Using the Launcher
To view available tasks the launcher can call, run any of `tl -h`, `tl h`, `tl help` or `tl --help`:

image::tl_help.png[]

To run a task directly, simply call `tl` followed by the task name:

image::tl_cli_example.png[]

To launch the interactive menu, call `tl m` or `tl menu`:

image::tl_menu_example.png[]

You can then launch any of the tasks, or enter any of the sub menus by entering the numeric indicator next to the task description.

== Installation
Task Launcher can be called from any location in your terminal - you don't need to launch it from the location you've cloned it to every time.

To install the launcher, simply run it from the location you've cloned it to once, and it will self install via symlink into `/usr/local/bin` +
*_Note:_* _This may require `sudo` access and will attempt to elevate permissions if required._
[source,bash]
----
cd ~/projects/bash-task-launcher
./tl
----

=== Uninstallation
To stop Task Launcher being available to run anywhere in your shell, simply remove the symlink from `/usr/local/bin` +
*_Note:_* _This may require `sudo` access_
[source,bash]
----
sudo rm /usr/local/bin/tl
----

=== Shell Autocomplete
Task Launcher includes autocomplete files for both `bash` and `zsh` shells that list all the available tasks. +
*_Note:_* _Despite being a bash based CLI script, it will work when being called from other shells, as long as bash exists on the system_

To enable the autocomplete prompts: +
TODO: Document this!

To initiate the autocomplete prompts: +
*ZSH:* Type `tl` followed by a space to show the available tasks. Use the arrow keys to highlight and select a task, or start typing a task name to filter the list. +
*Bash:* Type `tl` then press tab to view available tasks.

==== Building the Autocomplete Files
After adding any tasks to the Task Launcher, you'll need to update the autocomplete files so they include your new tasks.

Simply run `tl build-autocomplete` to regenerate them.

_Don't forget to commit these files along with your task definitions if you've forked this repository / added it to an existing project that's in source control_

== Creating Tasks
=== Creating the Task Definition
To create your own task for the Task Launcher, first decide on the task name. +
This should be short, so it's quick to type on the CLI, but still accurately describe what the task will do. +
Task names must be unique across the entire launcher - tasks on different sub menus cannot share names. +
*_Note:_* _Your task name can only contain the charactes `a-z` (lowercase only) and the `-` character. +
You cannot separate words in your task name with spaces or underscores._

Edit the file in `task_configs` that contains the menu or sub-menu that your task relates to. +
You can add all task and sub-menu definitions to a single file (such as `task_configs/main`) if you wish, however it is recommended to create a separate file for each sub-menu to keep the configs tidy and easy to maintain.

Copy the template below into the file you're adding the task to:
[source,bash]
----
example:menu() (echo MAIN_MENU)
example:describe() (echo 'This is the task description')
example() {
    # Enter your commands here
}
----
Replace the `example` task name with your new task name.

If your task needs to be in a sub-menu, replace `MAIN_MENU` with the name of your sub-menu.

Enter a suitable description for the task, so it's clear what the task does. +
Keep the description short and concise, as very long descriptions will make the interactive menu unwieldy.

Enter the commands you want your task to run in the main task function.

Save the file and test it by running `tl task-name`

_When your new task is complete, update the autocomplete files to include it_

=== Creating Sub Menus
To prevent the initial menu screen from becoming overwhelming with many tasks in it, you can create sub-menus to group related tasks together intuitively. +
*_Note:_* _A task being in a sub-menu does not affect the way it is called on the CLI in any way_

It is recommended to create tasks in a sub-menu in a separate file to keep the config files from becoming difficult to maintain. +
However, if you want your sub-menu option to appear on the main menu, you should create the sub-menu task in the `task_configs/main` file. +
Task Launcher supports any level of nested sub-menus - to create a nested sub-menu, simply define the `:menu` function with the name of the menu you wish your sub-menu to appear on.

Edit the file in `task_configs` that contains the menu you want your sub-menu option to appear on. +
For example, to include it on the main menu, edit `task_configs/main`. +
*_Note:_* _This is purely for maintainability - you can add the definition to any file you like!_

Copy the template below into the file:
[source,bash]
----
example-menu:menu() (echo MAIN_MENU)
example-menu:meta() (echo NO-RUNNER)
example-menu:describe() (echo 'This is the menu description')
example-menu() {
	menu "$(tasks:menuitems EXAMPLE_MENU)"
}
----
Replace the `example-menu` task name with your new menu task name (e.g.: `npm-tools-menu`).

Do not edit the `:meta` definition. This is required to prevent the sub-menu task being listed as an available task to run.

Enter a suitable description for your sub-menu.

Inside the menu definition function, replace `EXAMPLE_MENU` with the name of your new menu (e.g.: `NPM_TOOLS_MENU`).

Update any tasks that you want to appear on the sub-menu, setting their `:menu` definition to match the name you have just assigned above. +
For example:
[source,bash]
----
example:menu() (echo EXAMPLE_MENU)
example:describe() (echo 'An example task')
example() {
    echo "This is an example task doing stuff"
}
----

=== Creating Task Config Files
To create a file to add task definitions to:
* Create the file: `touch ./task_configs/submenu`
* Make the file executable: `chmod +x ./task_configs/submenu`
* Add the bash shebang to the top of the file: `#!/usr/bin/env bash`